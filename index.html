<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <style>
          table {
            border-collapse: collapse;
          }
          td {
            padding: 0px;
          }
          td > div {
            width: 6.6vmin;
            height: 6.6vmin;
          }
          img {
            width: 100%;
            height: 100%;
          }
          div.bright {
            border: 0.1vmin solid #FFC0CB;
          }
          div.dark {
            border: 0.1vmin solid #707070;
          }
          div#buttons-container {
            display: flex;
            place-items: center;
            height: auto;
            width: 100vmin;
            margin: 5px;
            padding: 5px;
            border: 1px dashed #808080;
          }
        </style>
        <title>WBB的照片墙</title>
  </head>
  <body>
    <h1>照片墙～</h1>
    <div id="buttons-container">
      <button id='shuffle' style='margin: 5px'>图片重排</button>
      <button id='saveImage' style='margin: 5px'>保存图片墙</button>
      <h5 style='margin: 5px; color: red;'>点击小图片试一试！</h5>
    </div>
    <table>
        <tbody>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="bright"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
            <tr><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td><td><div class="dark"></div></td></tr>
    </tbody>
</table>
<p>注意：该页面仅供Web技术学习参考使用，请勿用于其他用途。<br>媒体资源为网上收集，如有侵权请联系删除。</p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js" integrity="sha512-tVYBzEItJit9HXaWTPo8vveXlkK62LbA+wez9IgzjTmFNLMBO1BEYladBw2wnM3YURZSMUyhayPCoLtjGh84NQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="images.json"></script>
<script>
  Array.prototype.shuffle = function() {
    var array = this;
    var m = array.length,
    t, i;
    while (m) {
      i = Math.floor(Math.random() * m--);
      t = array[m];
      array[m] = array[i];
      array[i] = t;
    }
    return array;
  }
  function downloadImgData(imgData, fileName) {
     const downloadLink = document.createElement("a");
     downloadLink.href = imgData;
     downloadLink.download = fileName;
     downloadLink.click();
  }
  $(document).ready(function(){
    const n_img = 150, n_bright = 35, n_dark = 115;
    var brightDiv = $("div.bright");
    var darkDiv = $("div.dark");
    function prepareImages(n, source_n, source_start=0){
      var src = [];
      for(let i = 0; i < n; i ++)
        src.push(imgs[ i % source_n + source_start]);
      return src;
    }
    var brightSrc = prepareImages(brightDiv.length, n_bright, 0);
    var darkSrc = prepareImages(darkDiv.length, n_dark, n_bright);
    function pushImages(el, imgSrc){
      var imgTag = "";
      var srcs = imgSrc.shuffle();
      for(let i = 0; i < el.length; i ++){
        imgTag = '<img src="' + srcs[i] + '"/>';
        $(el[i]).html(imgTag);
      }
    }
    pushImages(darkDiv, darkSrc);
    pushImages(brightDiv, brightSrc);
    $('td > div').click(function(){
      var randIdx = 0;
      if($(this).hasClass('bright')){
        $(this).attr('class', 'dark');
        randIdx = Math.floor(Math.random() * n_dark);
        $(this).children('img').attr('src', darkSrc[randIdx]);
      }
      else{
        $(this).attr('class', 'bright');
        randIdx = Math.floor(Math.random() * n_bright);
        $(this).children('img').attr('src', brightSrc[randIdx]);
      }
    });
    $('#shuffle').click(function(){
      var brightDiv = $("div.bright");
      var darkDiv = $("div.dark");
      var brightSrc = prepareImages(brightDiv.length, n_bright, 0);
      var darkSrc = prepareImages(darkDiv.length, n_dark, n_bright);
      pushImages(darkDiv, darkSrc);
      pushImages(brightDiv, brightSrc);
    });
    $('#saveImage').click(function(){
      var content = $('table')[0];
      var opts = {windowWidth: 2500, windowHeight: 2500};
      html2canvas(content, opts).then(canvas => {
        var imgData = canvas.toDataURL("image/jpeg", 0.9).replace("image/jpeg", "image/octet-stream");
        downloadImgData(imgData, 'picture.jpg');
      });
    });
  });
</script>
</body></html>
